ip addr add dev eth0 10.0.0.133/30
ip link set dev eth0 up

ip addr add dev eth1 192.168.0.21/29
ip link set dev eth1 up

ip addr add dev eth2 10.0.2.103/28
ip link set dev eth2 up

ip addr add dev eth3 10.0.2.119/28
ip link set dev eth3 up

ip addr add dev eth4 10.0.0.25/30
ip link set dev eth4 up

ip addr add dev eth5 10.0.0.129/30
ip link set dev eth5 up

ip route add 0.0.0.0/0 via 10.0.0.26

# Não faz override
# Inicialmente, tudo da Contatudo tem acesso ao exterior

# Bloquear tudo o que vai dos endereços privados para fora
iptables -A FORWARD -o eth4 -s 192.168.0.0/16 -j DROP

# Exterior tem acesso aos visitantes
iptables -A FORWARD -i eth4 -d 10.0.2.64/27 -j ACCEPT

# Visitantes sem acesso a privados
iptables -A FORWARD -s 10.0.2.64/27 -d 192.168.0.0/16 -j DROP

# Permitir o acesso ao serviço HTTP(80), HTTPS(443) a partir do exterior
# Permitir o acesso ao serviço email SMTP(143), IMAP(25) a partir do exterior
# Permitir o acesso ao serviço DNS(53), VPN(1194), SSH(22) a partir do exterior
iptables -A FORWARD -i eth4 -d 10.0.2.96/28 -p tcp -m multiport --dports 22,80,443,25,143,53,1194 -j ACCEPT
iptables -A FORWARD -i eth4 -d 10.0.2.96/28 -p udp -m multiport --dports 22,80,443,25,143,53,1194 -j ACCEPT

# Garantir resposta
iptables -A FORWARD -i eth4 -m state --state ESTABLISHED,RELATED -j ACCEPT

# Permite os IPs de dentro chegarem a fora - Spoofing
iptables -A FORWARD -o eth4 -s 10.0.2.64/26,10.0.0.128/26 -j ACCEPT
# Bloquear tudo o que vai para fora - Spoofing
iptables -A FORWARD -o eth4 -j DROP

# Nega os IPs de dentro chegarem a dentro da Contatudo - Spoofing
iptables -A FORWARD -i eth4 -s 10.0.2.64/26,10.0.0.128/26,192.168.0.0/16 -j DROP

# Bloquear tudo o que vem de fora
iptables -A FORWARD -i eth4 -j DROP


/etc/init.d/zebra start
/etc/init.d/dhcp3-server start
/etc/init.d/snmpd start